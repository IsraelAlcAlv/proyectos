theme(axis.text.x = element_text(face = "bold", color="blue" ,
size = 10, angle = 45,
hjust = 1),
axis.text.y = element_text(face = "bold", color=" blue" ,
size = 10, angle = 45,
hjust = 1))
ggplot(data= original,
aes(x = default)) +
geom_bar() +
xlab("Default") +
ylab("Frecuencia") +
ggtitle("Pagaron vs No Pagaron")+
theme(plot.title = element_text(size=15, face = "bold"))  +
theme(axis.text.x = element_text(face = "bold", color="blue" ,
size = 10, angle = 45,
hjust = 1),
axis.text.y = element_text(face = "bold", color=" blue" ,
size = 10, angle = 45,
hjust = 1))
ggplot(data= original,
aes(x = default)) +
geom_bar() +
xlab("Default") +
ylab("Frecuencia") +
ggtitle("Pagaron vs No Pagaron")+
theme(plot.title = element_text(size=15, face = "bold", hjust = 0.5))  +
theme(axis.text.x = element_text(face = "bold", color="blue" ,
size = 10, angle = 45,
hjust = 1),
axis.text.y = element_text(face = "bold", color=" blue" ,
size = 10, angle = 45,
hjust = 1))
library(ggplot2)
library(dplyr)
#Importando la Base
original <- read.csv("original.csv", header = T)
str(original)
#Checamos la estructura
summary(original)
#Renombramos los nombres al Espanol
original <- rename(original, ingreso = income, edad = age, prestamo = loan)
ggplot(data= original,
aes(x = default)) +
geom_bar() +
xlab("Default") +
ylab("Frecuencia") +
ggtitle("Pagaron vs No Pagaron")+
theme(plot.title = element_text(size=15, face = "bold", hjust = 0.5))  +
theme(axis.text.x = element_text(face = "bold", color="blue" ,
size = 10, angle = 45,
hjust = 1),
axis.text.y = element_text(face = "bold", color=" blue" ,
size = 10, angle = 45,
hjust = 1))
ggplot(data= original,
aes(x = default)) +
geom_bar() +
xlab("Default") +
ylab("Frecuencia") +
ggtitle("Pagaron vs No Pagaron")+
theme(plot.title = element_text(size=15, face = "bold", hjust = 0.5))  +
theme(axis.text.x = element_text(face = "bold", color="blue" ,
size = 10, angle = 45,
hjust = 1),
axis.text.y = element_text(face = "bold", color=" blue" ,
size = 10, angle = 45,
hjust = 1))
(my_boxplot <- ggplot(data = original,
mapping = aes(x = default ,y = ingreso)) +
geom_boxplot())
(my_boxplot <- ggplot(data = original,
mapping = aes(x = default ,y = ingreso)) +
geom_boxplot())
(my_boxplot <- ggplot(data = original,
mapping = aes(x = default ~ ingreso)) +
geom_boxplot())
boxplot(original$default ~ original$ingreso)
boxplot(original$ingreso ~ original$default)
boxplot(original$edad ~ original$default)
boxplot(original$prestamo ~ original$default)
Conf1x3 <-  matrix(c(1:3), nrow=3, byrow=FALSE)
Conf1x3
layout(Conf1x3)
layout.show(3)
layout(Conf1x3)
layout.show(3)
Conf1x3 <-  matrix(c(1:3), ncol =3, byrow=FALSE)
Conf1x3
layout(Conf1x3)
layout.show(3)
boxplot(original$edad ~ original$default)
boxplot(original$ingreso ~ original$default)
boxplot(original$prestamo ~ original$default)
layout.show(3)
boxplot(original$edad ~ original$default)
boxplot(original$ingreso ~ original$default)
boxplot(original$prestamo ~ original$default)
boxplot(original$edad ~ original$default)
layout(Conf1x3)
boxplot(original$ingreso ~ original$default)
layout(boxplot(original$edad ~ original$default),
boxplot(original$ingreso ~ original$default),
boxplot(original$prestamo ~ original$default))
layout.show(3)
layout(Conf1x3)
layout(Conf1x3)
layout.show(3)
layout(Conf1x3)
layout.show(3)
boxplot(original$edad ~ original$default)
boxplot(original$ingreso ~ original$default)
boxplot(original$prestamo ~ original$default)
layout(Conf1x3) + theme(plot.title = "Hola")
layout.show(3)
boxplot(original$edad ~ original$default)
boxplot(original$ingreso ~ original$default)
boxplot(original$prestamo ~ original$default)
layout(Conf1x3)
layout.show(3)
boxplot(original$edad ~ original$default)
boxplot(original$ingreso ~ original$default)
boxplot(original$prestamo ~ original$default)
title("Hola")
layout(Conf1x3)
layout.show(3)
boxplot(original$edad ~ original$default)
title("Hola")
boxplot(original$ingreso ~ original$default)
title("Hola")
boxplot(original$prestamo ~ original$default)
title("Hola")
(layout(Conf1x3)
layout.show(3)
boxplot(original$edad ~ original$default)
title("Hola")
boxplot(original$ingreso ~ original$default)
title("Hola")
boxplot(original$prestamo ~ original$default)
title("Hola"))
(layout(Conf1x3)
layout.show(3)
boxplot(original$edad ~ original$default)
title("Hola")
boxplot(original$ingreso ~ original$default)
title("Hola")
boxplot(original$prestamo ~ original$default)
title("Hola"))
layout(Conf1x3)
layout.show(3)
boxplot(original$edad ~ original$default)
title("Hola")
boxplot(original$ingreso ~ original$default)
title("Hola")
boxplot(original$prestamo ~ original$default)
title("Hola")
layout(Conf1x3)
layout.show(3)
boxplot(original$edad ~ original$default)
title("Hola", xlab = "Pago")
boxplot(original$ingreso ~ original$default)
title("Hola")
boxplot(original$prestamo ~ original$default)
title("Hola")
layout(Conf1x3)
layout.show(3)
boxplot(original$edad ~ original$default)
title("Hola", xlab = "Pago = 0 | No Pago = 1")
boxplot(original$ingreso ~ original$default)
title("Hola")
boxplot(original$prestamo ~ original$default)
title("Hola")
attach(original)
layout(Conf1x3)
layout.show(3)
boxplot(edad ~ default)
title("Hola", xlab = "Pago = 0 | No Pago = 1")
boxplot(original$ingreso ~ original$default)
title("Hola")
boxplot(original$prestamo ~ original$default)
title("Hola")
boxplot(edad ~ default)
boxplot(edad ~ default, xlab = "")
title("Hola", xlab = "Pago = 0 | No Pago = 1")
layout(Conf1x3)
layout.show(3)
boxplot(edad ~ default, xlab = "", ylab = "")
title("Hola", xlab = "Pago = 0 | No Pago = 1")
boxplot(ingreso ~ default,  xlab = "", ylab = "")
title("Hola", xlab = "Pago = 0 | No Pago = 1")
boxplot(prestamo ~ default,  xlab = "", ylab = "")
title("Hola", xlab = "Pago = 0 | No Pago = 1")
layout(Conf1x3)
layout.show(3)
boxplot(edad ~ default, xlab = "", ylab = "")
title("Boxplot - Edades por Defaults", xlab = "Pago = 0 | No Pago = 1")
boxplot(ingreso ~ default,  xlab = "", ylab = "")
title("Boxplot - Ingresos por Defaults", xlab = "Pago = 0 | No Pago = 1")
boxplot(prestamo ~ default,  xlab = "", ylab = "")
title("Boxplot - Cantidad Prestada por Defaults", xlab = "Pago = 0 | No Pago = 1")
ggplot(data= original,
aes(x = default)) +
geom_bar() +
xlab("Default") +
ylab("Frecuencia") +
ggtitle("Pagaron vs No Pagaron")+
theme(plot.title = element_text(size=15, face = "bold", hjust = 0.5))  +
theme(axis.text.x = element_text(face = "bold", color="blue" ,
size = 10, angle = 45,
hjust = 1),
axis.text.y = element_text(face = "bold", color=" blue" ,
size = 10, angle = 45,
hjust = 1))
ggplot(data= original,
aes(x = default)) +
geom_bar() +
xlab("Default") +
ylab("Frecuencia") +
ggtitle("Pagaron vs No Pagaron")+
theme(plot.title = element_text(size=15, face = "bold", hjust = 0.5))  +
theme(axis.text.x = element_text(face = "bold", color="blue" ,
size = 10, angle = 45,
hjust = 1),
axis.text.y = element_text(face = "bold", color=" blue" ,
size = 10, angle = 45,
hjust = 1))
library(ggplot2)
library(dplyr)
library("InformationValue")
#Importando la Base
original <- read.csv("original.csv", header = T)
str(original)
names(original)
#Checamos la estructura
summary(original)
#Renombramos los nombres al Espanol
original <- rename(original, ingreso = income, edad = age, prestamo = loan)
attach(original)
ggplot(data= original,
aes(x = default)) +
geom_bar() +
xlab("Default") +
ylab("Frecuencia") +
ggtitle("Pagaron vs No Pagaron")+
theme(plot.title = element_text(size=15, face = "bold", hjust = 0.5))  +
theme(axis.text.x = element_text(face = "bold", color="blue" ,
size = 10, angle = 45,
hjust = 1),
axis.text.y = element_text(face = "bold", color=" blue" ,
size = 10, angle = 45,
hjust = 1))
layout(Conf1x3)
layout.show(3)
boxplot(edad ~ default, xlab = "", ylab = "")
title("Boxplot - Edades por Defaults", xlab = "Pago = 0 | No Pago = 1")
boxplot(ingreso ~ default,  xlab = "", ylab = "")
title("Boxplot - Ingresos por Defaults", xlab = "Pago = 0 | No Pago = 1")
boxplot(prestamo ~ default,  xlab = "", ylab = "")
title("Boxplot - Cantidad Prestada por Defaults", xlab = "Pago = 0 | No Pago = 1")
# Boxplots
Conf1x3 <-  matrix(c(1:3), ncol =3, byrow=FALSE)
Conf1x3
# Boxplots
Conf1x3 <-  matrix(c(1:3), ncol =3, byrow=FALSE)
layout(Conf1x3)
layout.show(3)
boxplot(edad ~ default, xlab = "", ylab = "")
title("Boxplot - Edades por Defaults", xlab = "Pago = 0 | No Pago = 1")
boxplot(ingreso ~ default,  xlab = "", ylab = "")
title("Boxplot - Ingresos por Defaults", xlab = "Pago = 0 | No Pago = 1")
boxplot(prestamo ~ default,  xlab = "", ylab = "")
title("Boxplot - Cantidad Prestada por Defaults", xlab = "Pago = 0 | No Pago = 1")
# Dispersión
plot(default,edad)
plot(default,ingresos)
title("Dispersión - Ingresos por Defaults", xlab = "Pago = 0 | No Pago = 1")
# Dispersión
plot(default,ingresos)
plot(default,ingreso)
title("Dispersión - Ingresos por Defaults", xlab = "Pago = 0 | No Pago = 1")
plot(default,edad)
title("Dispersión - Edades por Defaults", xlab = "Pago = 0 | No Pago = 1")
plot(default,prestamo)
title("Dispersión - Cantidad Prestada por Defaults", xlab = "Pago = 0 | No Pago = 1")
plot(default,ingreso)
title("Dispersión - Ingresos por Defaults", xlab = "Pago = 0 | No Pago = 1")
plot(default,ingreso, ylab = "Ingresos")
title("Dispersión - Ingresos por Defaults", xlab = "Pago = 0 | No Pago = 1")
plot(default,ingreso, ylab = "Ingresos", xlab = "")
title("Dispersión - Ingresos por Defaults", xlab = "Pago = 0 | No Pago = 1")
layout(Conf1x3)
layout.show(3)
plot(default,ingreso, ylab = "Ingresos", xlab = "")
title("Dispersión - Ingresos por Defaults", xlab = "Evento:|Pago = 0 | No Pago = 1")
plot(default,edad, ylab = "Edades", xlab = "")
title("Dispersión - Edades por Defaults", xlab = "Evento:|Pago = 0 | No Pago = 1")
plot(default,prestamo, ylab = "Cantidad Prestada", xlab = "")
title("Dispersión - Cantidad Prestada por Defaults", xlab = "Evento:|Pago = 0 | No Pago = 1")
# Histogramas
hist(ingreso, breaks = 100)
# Histogramas
hist(ingreso, breaks = 100, xlim = min(ingreso)-100)
# Histogramas
hist(ingreso, breaks = 100, xlim = min(ingreso))
# Histogramas
hist(ingreso, breaks = 100)
# Histogramas
hist(ingreso, breaks = 100)
hist(edad, breaks = 100, xlab = "Edades")
title("Histrograma de Edades")
eaks = 100, xlab = "Edades")
title("Histro
hist(edad, breaks = 100, xlab = "Edades")
title("Histrograma de Edades")
hist(edad, breaks = 100, xlab = "Edades")
hist(edad, breaks = 100, xlab = "Edades")
title("Histrograma de Edades")
plot(default,ingreso, ylab = "Ingresos", xlab = "")
title("Dispersión - Ingresos por Defaults", xlab = "Evento:|Pago = 0 | No Pago = 1")
hist(prestamo, breaks = 100, xlab = "Cantidad Prestada")
# Histogramas
Conf3x1 <-  matrix(c(1:3), ncol =1, byrow=FALSE)
layout(Con3x1)
layout.show(3)
hist(ingreso, breaks = 100, xlab = "Ingresos")
hist(edad, breaks = 100, xlab = "Edades")
hist(prestamo, breaks = 100, xlab = "Cantidad Prestada")
Conf3x1
layout(Con3x1)
# Histogramas
Conf3x1 <-  matrix(c(1:3), ncol =1, byrow=FALSE)
layout(Con3x1)
# Histogramas
Conf3x1 <-  matrix(c(1:3), ncol =1)
Conf3x1
layout(Con3x1)
layout.show(3)
# Histogramas
Conf3x1 <-  matrix(c(1:3), nrow =1)
layout(Con3x1)
# Histogramas
Conf3x1 <-  matrix(c(1:3), nrow =1)
layout(Conf3x1)
# Histogramas
Conf3x1 <-  matrix(c(1:3), nrow =1, byrow = F)
layout(Conf3x1)
layout(Conf3x1)
layout.show(3)
layout(Conf3x1)
layout.show(3)
hist(ingreso, breaks = 100, xlab = "Ingresos")
hist(edad, breaks = 100, xlab = "Edades")
hist(prestamo, breaks = 100, xlab = "Cantidad Prestada")
# Histogramas
Conf3x1 <-  matrix(c(1:3), nrow =3, byrow = F)
layout(Conf3x1)
layout.show(3)
hist(ingreso, breaks = 100, xlab = "Ingresos")
hist(edad, breaks = 100, xlab = "Edades")
hist(prestamo, breaks = 100, xlab = "Cantidad Prestada")
hist(ingreso, breaks = 100, xlab = "Ingresos", main = "Histrograma de Ingresos")
layout(Conf3x1)
layout.show(3)
hist(ingreso, breaks = 100, xlab = "Ingresos", main = "Histrograma de Ingresos")
hist(edad, breaks = 100, xlab = "Edades", main = "Histrograma de Edades")
hist(prestamo, breaks = 100, xlab = "Cantidad Prestada", main = "Histrograma de Prestamo")
#Vemos que hay na's. edades negativas y prestamos negativos, las componemos
original <- na.omit(original)
original[original$edad<0,3] <- original[original$edad<0,3]*(-1)
summary(original)
layout(Conf1x3)
layout.show(3)
boxplot(edad ~ default, xlab = "", ylab = "")
title("Boxplot - Edades por Defaults", xlab = "Evento:| Pago = 0 | No Pago = 1")
boxplot(ingreso ~ default,  xlab = "", ylab = "")
title("Boxplot - Ingresos por Defaults", xlab = "Evento:|Pago = 0 | No Pago = 1")
boxplot(prestamo ~ default,  xlab = "", ylab = "")
title("Boxplot - Cantidad Prestada por Defaults", xlab = "Evento:|Pago = 0 | No Pago = 1")
summary(original)
Conf1x3 <-  matrix(c(1:3), ncol =3, byrow=FALSE)
layout(Conf1x3)
layout.show(3)
boxplot(edad ~ default, xlab = "", ylab = "")
title("Boxplot - Edades por Defaults", xlab = "Evento:| Pago = 0 | No Pago = 1")
boxplot(ingreso ~ default,  xlab = "", ylab = "")
title("Boxplot - Ingresos por Defaults", xlab = "Evento:|Pago = 0 | No Pago = 1")
boxplot(prestamo ~ default,  xlab = "", ylab = "")
title("Boxplot - Cantidad Prestada por Defaults", xlab = "Evento:|Pago = 0 | No Pago = 1")
detach(original)
boxplot(original$edad ~ original$default, xlab = "", ylab = "")
title("Boxplot - Edades por Defaults", xlab = "Evento:| Pago = 0 | No Pago = 1")
layout(Conf1x3)
layout.show(3)
boxplot(original$edad ~ original$default, xlab = "", ylab = "")
title("Boxplot - Edades por Defaults", xlab = "Evento:| Pago = 0 | No Pago = 1")
boxplot(original$ingreso ~ original$default,  xlab = "", ylab = "")
title("Boxplot - Ingresos por Defaults", xlab = "Evento:|Pago = 0 | No Pago = 1")
boxplot(original$prestamo ~ original$default,  xlab = "", ylab = "")
title("Boxplot - Cantidad Prestada por Defaults", xlab = "Evento:|Pago = 0 | No Pago = 1")
Rlog<-glm(formula=default~ingreso+edad+prestamo,original, family=binomial(link='logit'))
summary(Rlog)
exp(coefficients(Rlog))
#Estadistico de prueba
with(Rlog,null.deviance-deviance)
#Valor p
with(Rlog,pchisq(null.deviance-deviance,df.null-df.residual,lower.tail=FALSE))
original$Predict <- Rlog$fitted.values
View(original)
PuntoCorte<-optimalCutoff(original$default,original$Predict,optimiseFor = "Both")
PuntoCorte
obsCorrectas<-1- misClassError(original$default,original$Predict, threshold = PuntoCorte)
confusionMatrix(original$default,original$Predict)
View(original)
ggplot(data= original,
aes(x = default)) +
geom_bar() +
xlab("Evento:|0 = Pago|1 = No Pago ") +
ylab("Frecuencia") +
ggtitle("Pagaron vs No Pagaron")+
theme(plot.title = element_text(size=15, face = "bold", hjust = 0.5))  +
theme(axis.text.x = element_text(face = "bold", color="blue" ,
size = 10, angle = 45,
hjust = 1),
axis.text.y = element_text(face = "bold", color=" blue" ,
size = 10, angle = 45,
hjust = 1))
# Boxplots
Conf1x3 <-  matrix(c(1:3), ncol =3, byrow=FALSE)
layout(Conf1x3)
layout.show(3)
boxplot(edad ~ default, xlab = "", ylab = "")
title("Boxplot - Edades por Defaults", xlab = "Evento:| Pago = 0 | No Pago = 1")
boxplot(ingreso ~ default,  xlab = "", ylab = "")
title("Boxplot - Ingresos por Defaults", xlab = "Evento:|Pago = 0 | No Pago = 1")
boxplot(prestamo ~ default,  xlab = "", ylab = "")
title("Boxplot - Cantidad Prestada por Defaults", xlab = "Evento:|Pago = 0 | No Pago = 1")
attach(original)
layout(Conf1x3)
layout.show(3)
boxplot(edad ~ default, xlab = "", ylab = "")
title("Boxplot - Edades por Defaults", xlab = "Evento:| Pago = 0 | No Pago = 1")
boxplot(ingreso ~ default,  xlab = "", ylab = "")
title("Boxplot - Ingresos por Defaults", xlab = "Evento:|Pago = 0 | No Pago = 1")
boxplot(prestamo ~ default,  xlab = "", ylab = "")
title("Boxplot - Cantidad Prestada por Defaults", xlab = "Evento:|Pago = 0 | No Pago = 1")
detach(original)
library(ggplot2)
library(dplyr)
library("InformationValue")
original <- read.csv("original.csv", header = T)
original <- rename(original, ingreso = income, edad = age, prestamo = loan)
#Vemos que hay na's. edades negativas y prestamos negativos, las componemos
original <- na.omit(original)
original[original$edad<0,3] <- original[original$edad<0,3]*(-1)
#
summary(original)
Rlog<-glm(formula=default~ingreso+edad+prestamo,original, family=binomial(link='logit'))
summary(Rlog)
exp(coefficients(Rlog))
#Estadistico de prueba
with(Rlog,null.deviance-deviance)
#Valor p
with(Rlog,pchisq(null.deviance-deviance,df.null-df.residual,lower.tail=FALSE))
#Estadistico de prueba
anova(Rlog, test = "Chisq")
dif_residuos <- Rlog$null.deviance - Rlog$deviance
# Grados libertad
df <- Rlog$df.null - Rlog$df.residual
# p-value
p_value <- pchisq(q = dif_residuos,df = df, lower.tail = FALSE)
paste("Diferencia de residuos:", round(dif_residuos, 4))
paste("Grados de libertad:", df)
paste("p-value:", round(p_value, 4))
###prueba de significancia
# Diferencia de residuos
dif_residuos <- Rlog$null.deviance - Rlog$deviance
dif_residuos
# Grados libertad
df <- Rlog$df.null - Rlog$df.residual
# p-value
p_value <- pchisq(q = dif_residuos,df = df, lower.tail = FALSE)
p_value
paste("Diferencia de residuos:", round(dif_residuos, 4))
paste("Grados de libertad:", df)
paste("p-value:", round(p_value, 4))
# p-value
p_value <- pchisq(q = dif_residuos,df = df, lower.tail = FALSE)
p_value
##################
predicciones <- ifelse(test = Rlog$fitted.values > 0.5, yes = 1, no = 0)
matriz_confusion <- table(Rlog$model$default, predicciones,
dnn = c("observaciones", "predicciones"))
matriz_confusion
mosaic(matriz_confusion, shade = T, colorize = T,
gp = gpar(fill = matrix(c("green3", "red2", "red2", "green3"), 2, 2)))
library(vcd)
#Comenzamos por instalar y o llamar las librerías necesarias:
#install.packages("dplyr")
#install.packages("ggplot2")
##install.packages('InformationValue')
install.packages("vcd")
library(vcd)
mosaic(matriz_confusion, shade = T, colorize = T,
gp = gpar(fill = matrix(c("green3", "red2", "red2", "green3"), 2, 2)))
##################
predicciones <- ifelse(test = Rlog$fitted.values > 0.5, yes = 1, no = 0)
matriz_confusion <- table(Rlog$model$default, predicciones,
dnn = c("Observaciones", "Predicciones"))
matriz_confusion
mosaic(matriz_confusion, shade = T, colorize = T,
gp = gpar(fill = matrix(c("green3", "red2", "red2", "green3"), 2, 2)))
mosaic(matriz_confusion, shade = T, colorize = T,
gp = gpar(fill = matrix(c("green3", "red2", "red2", "green3"), 2, 2)))
